/*
 * Localisation.js
 *
 * Author: Matthew Harrison-Jones
 * Author Website: matthojo.co.uk
 * License: MIT <http://en.wikipedia.org/wiki/MIT_License>
 *
 */var _st=window.setTimeout;window.setTimeout=function(e,t){if(typeof e=="function"){var n=Array.prototype.slice.call(arguments,2),r=function(){e.apply(null,n)};return _st(r,t)}return _st(e,t)};var localisation=function(e,t){var n,r,i=!1;if(!t){var s=e,o={},u=new XMLHttpRequest;u.open("GET",s,!0);u.onreadystatechange=function(){var e=4,t=200;if(u.readyState==e&&u.status==t){n=JSON.parse(u.responseText);i=!0}};u.send(null)}else{var a=JSON.stringify(e);n=JSON.parse(a);i=!0}this.setLanguage=function(e){if(e=="auto"){var t=window.navigator.userLanguage||window.navigator.language;t=t.replace("-","_");this.language=t;console.log("Language Auto set to: "+this.language)}else this.language=e;return this.language};this.createLanguageChooser=function(e,t,r,s){var o;if(i){var u=[];for(var a in n)if(n.hasOwnProperty(a)){var f="";n[a].language_name?f=n[a].language_name:f=a;var l={text:f,value:a};u.push(l)}var c=document.createElement("select");c.className+=e;var h=document.createElement("option");h.text=t;h.value="auto";c.options.add(h);for(var p=0;p<u.length;p++){h=document.createElement("option");h.text=u[p].text;h.value=u[p].value;c.options.add(h)}if(r){var d=document.getElementsByTagName("script"),v=d[d.length-1];v.parentNode.insertBefore(c,v)}else var m=setInterval(function(){document.readyState==="complete"&&document.getElementById(s).appendChild(c)},10);clearTimeout(o);return c}o=setTimeout(this.createLanguageChooser,100,e,t,r,s)};this.returnString=function(e){if(i)return n[this.language][e];setTimeout(this.returnString,100,e)}};